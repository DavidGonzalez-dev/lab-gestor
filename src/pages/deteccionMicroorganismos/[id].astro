---
import { OrganismoCard } from "@features/microOrganismos/components/MicroCard/OrganismosCard";
import SidebarLayout from "@shared/layouts/SidebarLayout.astro";
import PillHeading from "@shared/components/PillHeading/PillHeading.astro";
import { TablaMonitoreos } from "@features/monitoreosMicroorganismos/components/TablaMonitoreos/TablaMonitoreos";

import { Button } from "@shared/components";
import { ArrowBackIcon } from "@shared/iconos";

import { VistaOrganismosID } from "@features/microOrganismos/services";

const { id } = Astro.params;

// Traemos la informacion del analisis
let organismo = null;
try {
  organismo = await VistaOrganismosID(id);
} catch (error) {
  console.error(error);
}
---

<SidebarLayout>
  <div class="container mainContainer">
    <div class="header">
      <PillHeading variant="primary">
        <h1>Detalle Deteccion</h1>
      </PillHeading>

      <a href={`/productos/${organismo.numeroRegistroProducto}`}>
        <Button variant="buttonCancel">
          Atras
          <ArrowBackIcon />
        </Button>
      </a>
    </div>

    <!-- Informacion del analisis -->
    <section>
      {
        organismo ? (
          <OrganismoCard client:load Organismo={organismo} />
        ) : (
          <p>No se encontró información del Microorganismo</p>
        )
      }
    </section>

    <!-- Monitoreos de Detecciones -->
    <section id="monitoreos-detecciones">
      <div>
        <h2>Monitoreos Deteccion</h2>
        <p>
          Aqui puedes registrar y gestionar los monitoreos que les hagas a las
          detecciones de microorganismos especificos
        </p>
      </div>
      <TablaMonitoreos client:visible idRecuento={organismo.id} />
    </section>
  </div>
</SidebarLayout>

<style>
  a {
    text-decoration: none;
  }

  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
  }

  .mainContainer {
    margin-top: 5dvh;
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  h2 {
    font-size: 1.7rem;
    font-weight: 600;
    color: var(--color-primario);
    margin-bottom: 10px;
  }

  p {
    font-size: 1rem;
  }

</style>
